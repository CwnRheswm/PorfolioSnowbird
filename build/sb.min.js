var $=function(a){return document.querySelectorAll(a)};!function(){var a,b,c,d,e=$(".weatherWidgetBtn")[0],f=$(".navWidgetBtn")[0],g=($("#headerBar")[0],$("#header")[0],$(".drawer")[0]),h=($(".cubeContent")[0],$(".navIcon")[0]),i=$(".rightCol ul")[0],j=2e3,k="localhost"===window.location.hostname,l=new Date;onPageLoad=function(){d=weather.getWeather(),console.log(d," ",d.forecast);for(var a=0;5>a;a++){var b,c,e,f,g,h={};if(h=weather.setWeather(d.forecast[a],a),0===a){for(var j=$(".currentTemp .icon")[0],k=$(".weatherWidgetBtn .icon")[0],l=0;a<h.icon.length;l++)j.classList.add(h.icon[l]),k.classList.add(h.icon[l]),k.classList.add("black");$(".currentTemp .temp")[0].innerHTML=Math.round(h.temp)+"&deg"}b=document.createElement("h5"),b.appendChild(document.createTextNode(h.day)),b.className="day",c=document.createElement("span");for(var m=h.icon.concat(["icon","blue"]),n=0;n<m.length;n++)c.classList.add(m[n]);e=document.createElement("span"),e.innerHTML=Math.round(h.high)+"&deg",e.className="high",f=document.createElement("span"),f.innerHTML=Math.round(h.low)+"&deg",f.className="low",g=document.createElement("li"),g.appendChild(b),g.appendChild(c),g.appendChild(e),g.appendChild(f),i.appendChild(g)}},weather=function(){return _getWeatherFromOWM=function(){if(k)return fauxWeather={coord:{lon:-.13,lat:51.51},forecast:{0:{weather:[{id:800,main:"Clear",description:"sky is clear",icon:"10n"}],main:{temp:12.73,pressure:814.36,humidity:61,temp_min:0,temp_max:15.22},wind:{speed:10.3,deg:290,gust:15.4}},1:{weather:[{id:500,main:"Rain",description:"light rain",icon:"10n"}],main:{temp:12.73,pressure:814.36,humidity:61,temp_min:1,temp_max:11.46},wind:{speed:10.3,deg:290,gust:15.4}},2:{weather:[{id:800,main:"Clear",description:"sky is clear",icon:"01n"}],main:{temp:12.73,pressure:814.36,humidity:61,temp_min:4.11,temp_max:14.78},wind:{speed:10.3,deg:290,gust:15.4}},3:{weather:[{id:500,main:"Rain",description:"light rain",icon:"10n"}],main:{temp:14.64,pressure:814.36,humidity:61,temp_min:4.11,temp_max:14.64},wind:{speed:10.3,deg:290,gust:15.4}},4:{weather:[{id:802,main:"Rain",description:"light rain",icon:"10n"}],main:{temp:9,pressure:814.36,humidity:61,temp_min:2,temp_max:9},wind:{speed:10.3,deg:290,gust:15.4}}},name:"London",dateSet:new Date};var a={today:"",forecast:""},b=arguments.units||"metric",c=arguments.city||"snowbird, UT",d=(arguments.forcastDays||"5","2a875b5c2a61bdb14dc7f2af6876cf7b"),e="http://api.openweathermap.org/data/2.5/",f="?q="+c+"&cnt="+forcastDays+"&mode=json&units="+b+"&callback=?&APPID="+d;(callService=function(a){var b="_"+new Date,c=document.createElement("script"),d=$("#head")[0]||document.documentElement;window[b]=function(){d.removeChild(c)},c.src=a.replace("callback=?","callback="+b),d.appendChild(c)})(e+"weather"+f,function(b){a.today=b,callService(e+"forecast/daily"+f,function(b){return a.forecast=b,a})})},_parseOWMIcon=function(a){var b=[];switch(a.substr(0,2)){case"02":case"03":b.push("partlyCloudy");break;case"04":case"50":b.push("cloudy");break;case"09":case"10":case"11":b.push("rain");break;case"13":b.push("snow");break;default:b.push("clear")}switch(a.substr(2,1)){case"n":b.push("night")}return b},_getWeather=function(){var a=sessionStorage.weatherObject;return void 0!==a?a.dateSet.getTime()>l.getTime()+432e5?_getWeatherFromOWM():a:_getWeatherFromOWM()},_setWeather=function(a,b){var c=["sun","mon","tue","wed","thu","fri","sat"],d=l.getDay(),e={day:"",icon:"",high:"",low:"",temp:""};return a?(b>-1&&(d+=b,d>6&&(d-=7),e.day=c[d]),e.icon=_parseOWMIcon(a.weather[0].icon),e.high=a.main.temp_max,e.low=a.main.temp_min,e.temp=a.main.temp,e):void 0},_storeWeather=function(a){sessionStorage.setItem("weatherObject",JSON.stringify(a))},{getWeather:_getWeather,setWeather:_setWeather,storeWeather:_storeWeather}}(),g=function(){var a=$(".drawer")[0],b=$(".cubeContent")[0],c=$(".page")[0],d=$("#headerBlock")[0],e=10;return _open=function(f){b.classList.add(f),b.classList.add("closed"),setTimeout(function(){b.classList.remove("closed"),b.classList.add("opened"),a.classList.add("opened"),c.classList.add("opened"),d.classList.add("opened")},e)},_close=function(){b.classList.remove("opened"),a.classList.remove("opened"),c.classList.remove("opened"),d.classList.remove("opened"),setTimeout(function(){},j)},_setState=function(a,c){return c===!0?b.classList.add(a):c===!1?b.classList.remove(a):void 0},_toggleState=function(a){b.classList.toggle(a),2===arguments.length&&b.classList.toggle(a,arguments[1])},_state=function(a){return b.classList.contains(a)},{open:_open,close:_close,setState:_setState,toggleState:_toggleState,state:_state}}(),e.addEventListener("click",function(){a=g.state("opened"),b=g.state("weather"),c=g.state("nav"),a?c?g.toggleState("nav")&h.classList.remove("active")&e.classList.add("active")&g.toggleState("weather"):g.close()&e.classList.toggle("active",!1):g.open("weather")&g.toggleState("nav",!1)&e.classList.add("active")&console.log("Drawer is closed, open and set weather")}),f.addEventListener("click",function(){a=g.state("opened"),b=g.state("weather"),c=g.state("nav"),a?b?g.toggleState("weather")&e.classList.remove("active")&h.classList.add("active")&g.toggleState("nav"):g.close()&h.classList.toggle("active",!1):g.open("nav")&g.toggleState("weather",!1)&h.classList.add("active")}),onPageLoad()}();